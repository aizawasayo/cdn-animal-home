(self.webpackChunkanimal_home_beta=self.webpackChunkanimal_home_beta||[]).push([[2305,3968],{81150:function(e){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},43304:function(e,t,a){a(82109)({target:"Object",stat:!0},{is:a(81150)})},86676:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var o=a(21914),r=a(14367),n=a(16198),i=a(4367),c=(a(57327),a(41539),a(68309),a(35666),a(20629)),s=(a(12164),a(70276)),l=a(72217),d={name:"BoardAdd",data:function(){return{valid:!1,newBoard:{user:"",topic:"",content:"",photoSrc:[],icon:"",color:"",created_time:null},formRules:{require:[function(e){return!!e||"不能为空！"}]},topicList:[],topicOption:[],uploadList:[],breadNav:[{text:"首页",disabled:!1,href:"/"},{text:"社区",disabled:!0,href:"/community"},{text:"森友墙",disabled:!1,href:"/community/board"},{text:"发布我的信息",disabled:!0,href:"/community/board/add"}],tips:"森友墙用于村民们讨论游戏日常，留下对森友之家的建设意见等等。禁止现金交易，拉私群，违规者永久封禁账号。望发布信息的各位森友遵守规则。"}},computed:(0,i.Z)({},(0,c.Se)(["userId"])),created:function(){var e=this;this.commonApi.getOption("topic",(function(t){e.topicList=t})),(0,s.U)({type:"topic"}).then((function(t){e.topicOption=t.data}))},methods:{submit:function(){var e=this;return(0,n.Z)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.addForm.validate()){t.next=22;break}return e.addTopicInfo(),e.getTimeVal(),e.uploadList=[],e.newBoard.user=e.userId,t.prev=5,t.next=8,e.commonApi.multiUpload(e.uploadList);case 8:return e.newBoard.photoSrc=t.sent,t.next=11,addDesign(e.newBoard);case 11:a=t.sent,$Vue.$dialogLoader.showSnackbar(a.message,{color:"success"}),e.commonApi.resetForm(e),e.$router.push("/community/board"),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(5),$Vue.$dialogLoader.showSnackbar(err.message,{color:"error"});case 20:t.next=24;break;case 22:e.valid=!1,$Vue.$dialogLoader.showSnackbar("信息有误，请重新填写！",{color:"error"});case 24:case"end":return t.stop()}}),t,null,[[5,17]])})))()},addTopicInfo:function(){var e=this.newBoard.topic,t=this.topicOption.filter((function(t){return t.name===e}));this.newBoard.icon=t[0].icon,this.newBoard.color=t[0].color},getTimeVal:function(){var e=new Date,t=(0,l.TD)(e);this.newBoard.created_time=(0,l.AB)(t)}}},u=a(1001),p=a(43453),m=a.n(p),f=a(63150),v=a(82102),b=a(99846),h=a(27781),w=a(46232),x=a(62877),g=a(47032),k=a(34350),B=(0,u.Z)(d,(function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("v-container",{staticClass:"bgWht",attrs:{"elevation-4":""}},[n(r.default,{attrs:{"bread-nav":t.breadNav}}),n(o.default,{attrs:{title:"发布我的信息",tips:t.tips,hasTip:""}}),n("v-form",{ref:"addForm",staticClass:"pa-16",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-row",[n("v-col",{attrs:{cols:"4"}},[n("v-select",{attrs:{items:t.topicList,label:"话题",placeholder:"请选择",rules:t.formRules.require},model:{value:t.newBoard.topic,callback:function(e){t.$set(t.newBoard,"topic",e)},expression:"newBoard.topic"}})],1),n("v-col",{attrs:{cols:"4"}},[n("v-file-input",{attrs:{accept:"image/*",label:"图片",placeholder:"请上传",multiple:"","prepend-icon":"mdi-camera",rules:t.formRules.require},on:{"click:clear":function(){return t.commonApi.clearFiles(e,"newBoard")}},model:{value:t.uploadList,callback:function(e){t.uploadList=e},expression:"uploadList"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{height:"100",label:"说明",hint:"灵感来源，设计思路等等，畅所欲言",placeholder:"请输入"},model:{value:t.newBoard.content,callback:function(e){t.$set(t.newBoard,"content",e)},expression:"newBoard.content"}})],1)],1),n("div",{staticClass:"form-btns d-flex justify-lg-space-between mt-4 mx-auto"},[n("v-btn",{staticClass:"mr-4",attrs:{disabled:!t.valid,color:"primary",large:""},on:{click:t.submit}},[t._v(" 提交 ")]),n("v-btn",{attrs:{color:"secondary",large:""},on:{click:function(){return t.commonApi.resetForm(e)}}},[t._v(" 重置 ")])],1)],1)],1)}),[],!1,null,"a7460a3a",null),V=B.exports;m()(B,{VBtn:f.Z,VCol:v.Z,VContainer:b.Z,VFileInput:h.Z,VForm:w.Z,VRow:x.Z,VSelect:g.Z,VTextarea:k.Z})}}]);