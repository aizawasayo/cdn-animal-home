"use strict";(self.webpackChunkanimal_home_beta=self.webpackChunkanimal_home_beta||[]).push([[2879,3968],{19868:function(e,a,t){t.r(a),t.d(a,{default:function(){return q}});var s=t(21914),r=t(14367),o=t(4367),l=t(27853),n=(t(68309),t(74916),t(15306),t(10311)),i=t.n(n),u=t(20629),c=t(16165),d=t(87909),f=t(72217);i().component("DatePicker",l.Z);var m={name:"UserEdit",data:function(){return{valid:!1,userInfo:{_id:"",username:"",nickname:"",gameId:"",islandDate:null,islandName:"",position:"",startDate:"",password:"",avatar:"",signature:""},formRules:{require:[function(e){return!!e||"不能为空！"}]},positionList:[{text:"北半球",value:"North"},{text:"南半球",value:"South"}],uploadPic:null,breadNav:[{text:"首页",disabled:!1,href:"/"},{text:"用户中心",disabled:!1,href:"/user"},{text:"修改个人信息",disabled:!0,href:"/user/edit"}],tips:"本页面用于动森玩家分享DIY设计(服装/帽子/图案均可)，图片格式接受jpg或png。"}},computed:(0,o.Z)({},(0,u.Se)(["userId"])),created:function(){this.getUserInfo()},methods:{getUserInfo:function(){var e=this;(0,c.PR)(this.userId).then((function(a){e.userInfo=a.data,e.userInfo.startDate&&(e.userInfo.islandDate=(0,f.HG)(e.userInfo.startDate))}))},submit:function(){var e=this;this.$refs.addForm.validate()?(null!==this.uploadPic&&(this.userInfo.avatar=this.uploadPic),this.userInfo.startDate=(0,f.AB)(this.userInfo.islandDate),(0,c.uz)(this.userId,this.userInfo).then((function(a){$Vue.$dialogLoader.showSnackbar(a.message,{color:"success"}),e.commonApi.resetForm(e),e.$router.push("/user")})).catch((function(e){return $Vue.$dialogLoader.showSnackbar(e.message,{color:"error"})}))):(this.valid=!1,$Vue.$dialogLoader.showSnackbar("信息有误，请重新填写！",{color:"error"}))},handleUpload:function(e){var a=this,t=new FormData;e&&(t.append("avatar",e,e.name),(0,d.w)(t).then((function(e){if(200===e.code){$Vue.$dialogLoader.showSnackbar(e.message,{color:"success"});var t=e.data.path;t=t.replace("/public",""),a.uploadPic=t}})).catch((function(e){return $Vue.$dialogLoader.showSnackbar(e.message,{color:"error"})})))},clearFiles:function(){this.uploadPic=null},test:function(){console.log(this.userInfo.startDate)}}},h=t(1001),p=t(43453),v=t.n(p),I=t(63150),b=t(82102),g=t(99846),k=t(27781),x=t(46232),$=t(62877),D=t(47032),w=t(40314),V=t(34350),Z=(0,h.Z)(m,(function(){var e=this,a=this,t=a.$createElement,o=a._self._c||t;return o("v-container",{staticClass:"bgWht",attrs:{"elevation-4":""}},[o(r.default,{attrs:{"bread-nav":a.breadNav}}),o(s.default,{attrs:{title:"修改个人信息",tips:a.tips,"has-tip":!1}}),o("v-form",{ref:"addForm",staticClass:"pa-16",attrs:{"lazy-validation":""},model:{value:a.valid,callback:function(e){a.valid=e},expression:"valid"}},[o("v-row",[o("v-col",{attrs:{cols:"4"}},[o("v-text-field",{attrs:{rules:a.formRules.require,label:"用户名",placeholder:"请输入",disabled:"",required:""},model:{value:a.userInfo.username,callback:function(e){a.$set(a.userInfo,"username",e)},expression:"userInfo.username"}})],1),o("v-col",{attrs:{cols:"4"}},[o("v-text-field",{attrs:{rules:a.formRules.require,label:"昵称",placeholder:"请输入",required:""},model:{value:a.userInfo.nickname,callback:function(e){a.$set(a.userInfo,"nickname",e)},expression:"userInfo.nickname"}})],1),o("v-col",{attrs:{cols:"4"}},[o("v-text-field",{attrs:{rules:a.formRules.require,label:"动森ID",placeholder:"请输入",required:""},model:{value:a.userInfo.gameId,callback:function(e){a.$set(a.userInfo,"gameId",e)},expression:"userInfo.gameId"}})],1),o("v-col",{attrs:{cols:"4"}},[o("v-select",{attrs:{items:a.positionList,label:"岛屿位置",placeholder:"请选择",rules:a.formRules.require},model:{value:a.userInfo.position,callback:function(e){a.$set(a.userInfo,"position",e)},expression:"userInfo.position"}})],1),o("v-col",{attrs:{cols:"4"}},[o("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择登岛日期"},on:{"on-change":a.test},model:{value:a.userInfo.islandDate,callback:function(e){a.$set(a.userInfo,"islandDate",e)},expression:"userInfo.islandDate"}})],1),o("v-col",{attrs:{cols:"4"}},[o("v-text-field",{attrs:{rules:a.formRules.require,label:"岛屿名称",placeholder:"请输入",required:""},model:{value:a.userInfo.islandName,callback:function(e){a.$set(a.userInfo,"islandName",e)},expression:"userInfo.islandName"}})],1),o("v-col",{attrs:{cols:"4"}},[o("v-file-input",{attrs:{accept:"image/*",label:"头像",placeholder:a.userInfo.avatar?"可修改":"请上传","prepend-icon":"mdi-camera"},on:{change:a.handleUpload,"click:clear":a.clearFiles}})],1),o("v-col",{attrs:{cols:"12"}},[o("v-textarea",{attrs:{height:"100",label:"个性说明",hint:"介绍下自己吧",placeholder:"这个人很懒，什么都没有留下"},model:{value:a.userInfo.signature,callback:function(e){a.$set(a.userInfo,"signature",e)},expression:"userInfo.signature"}})],1)],1),o("div",{staticClass:"form-btns d-flex justify-lg-space-between mt-4 mx-auto"},[o("v-btn",{staticClass:"mr-4",attrs:{disabled:!a.valid,color:"primary",large:""},on:{click:a.submit}},[a._v(" 提交 ")]),o("v-btn",{attrs:{color:"secondary",large:""},on:{click:function(){return a.commonApi.resetForm(e)}}},[a._v(" 重置 ")])],1)],1)],1)}),[],!1,null,"110c1e91",null),q=Z.exports;v()(Z,{VBtn:I.Z,VCol:b.Z,VContainer:g.Z,VFileInput:k.Z,VForm:x.Z,VRow:$.Z,VSelect:D.Z,VTextField:w.Z,VTextarea:V.Z})}}]);